
1. ë‹¨ì¼ í…Œì´ë¸” ê¸°ë³¸ ì¡°íšŒ
SELECT STORE_ID, PRODUCT_ID FROM SALES_TRANSACTION
{
  "sql": "SELECT STORE_ID, PRODUCT_ID FROM SALES_TRANSACTION"
}

2. ë‹¨ì¼ í…Œì´ë¸” + í•¨ìˆ˜
SELECT NVL(STORE_ID, 'X') FROM SALES_TRANSACTION
{
  "sql": "SELECT NVL(STORE_ID, 'X') FROM SALES_TRANSACTION"
}

3. ë‹¨ì¼ í…Œì´ë¸” + CASE
SELECT CASE WHEN QTY > 0 THEN 'Y' ELSE 'N' END FROM SALES_TRANSACTION
{
  "sql": "SELECT CASE WHEN QTY > 0 THEN 'Y' ELSE 'N' END FROM SALES_TRANSACTION"
}

4. JOIN + prefix ì‚¬ìš©
SELECT ST.STORE_ID, SM.STORE_NAME FROM SALES_TRANSACTION ST JOIN STORE_MASTER SM ON ST.STORE_ID = SM.STORE_ID
{
  "sql": "SELECT ST.STORE_ID, SM.STORE_NAME FROM SALES_TRANSACTION ST JOIN STORE_MASTER SM ON ST.STORE_ID = SM.STORE_ID"
}

5. JOIN + í•¨ìˆ˜
SELECT SUM(ST.QTY) FROM SALES_TRANSACTION ST JOIN STORE_MASTER SM ON ST.STORE_ID = SM.STORE_ID
{
  "sql": "SELECT SUM(ST.QTY) FROM SALES_TRANSACTION ST JOIN STORE_MASTER SM ON ST.STORE_ID = SM.STORE_ID"
}

6. WHERE + BETWEEN
SELECT ST.STORE_ID FROM SALES_TRANSACTION ST WHERE ST.TX_DATE BETWEEN '20240101' AND '20240131'
{
  "sql": "SELECT ST.STORE_ID FROM SALES_TRANSACTION ST WHERE ST.TX_DATE BETWEEN '20240101' AND '20240131'"
}

7. IN (ê°’ ëª©ë¡)
SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN ('A','B')
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN ('A','B')"
}

8. IN (ì„œë¸Œì¿¼ë¦¬)
SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN (SELECT STORE_ID FROM STORE_MASTER)
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN (SELECT STORE_ID FROM STORE_MASTER)"
}

9. EXISTS
SELECT STORE_ID FROM SALES_TRANSACTION ST WHERE EXISTS (SELECT 1 FROM STORE_MASTER SM WHERE ST.STORE_ID = SM.STORE_ID)
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION ST WHERE EXISTS (SELECT 1 FROM STORE_MASTER SM WHERE ST.STORE_ID = SM.STORE_ID)"
}

10. UNION ALL
SELECT STORE_ID FROM SALES_TRANSACTION UNION ALL SELECT STORE_ID FROM STORE_MASTER
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION UNION ALL SELECT STORE_ID FROM STORE_MASTER"
}


âŒ ì°¨ë‹¨ (INVALID)

11. ë‹¤ì¤‘ í…Œì´ë¸” prefix ëˆ„ë½
SELECT STORE_ID, STORE_NAME FROM SALES_TRANSACTION ST JOIN STORE_MASTER SM ON ST.STORE_ID = SM.STORE_ID
{
  "sql": "SELECT STORE_ID, STORE_NAME FROM SALES_TRANSACTION ST JOIN STORE_MASTER SM ON ST.STORE_ID = SM.STORE_ID"
}

âŒ ì´ìœ : ë‹¤ì¤‘ í…Œì´ë¸”ì—ì„œ prefix ì—†ëŠ” ì»¬ëŸ¼

12. í—ˆìš©ë˜ì§€ ì•Šì€ í•¨ìˆ˜
SELECT HACKFUNC(STORE_ID) FROM SALES_TRANSACTION
{
  "sql": "SELECT HACKFUNC(STORE_ID) FROM SALES_TRANSACTION"
}

13. DROP í¬í•¨
SELECT STORE_ID FROM SALES_TRANSACTION; DROP TABLE USERS
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION; DROP TABLE USERS"
}

14. EXECUTE IMMEDIATE
SELECT EXECUTE IMMEDIATE 'DROP TABLE X' FROM DUAL
{
  "sql": "SELECT EXECUTE IMMEDIATE 'DROP TABLE X' FROM DUAL"
}

15. UTL_FILE
SELECT UTL_FILE.FOPEN('X','Y','R') FROM DUAL
{
  "sql": "SELECT UTL_FILE.FOPEN('X','Y','R') FROM DUAL"
}

16. whitelist ë¯¸ë“±ë¡ í…Œì´ë¸”
SELECT * FROM UNKNOWN_TABLE
{
  "sql": "SELECT * FROM UNKNOWN_TABLE"
}

17. alias ì—†ëŠ” prefix
SELECT A.STORE_ID FROM SALES_TRANSACTION
{
  "sql": "SELECT A.STORE_ID FROM SALES_TRANSACTION"
}

18. ë‹¤ì¤‘ í…Œì´ë¸”ì—ì„œ prefix ì—†ëŠ” ì»¬ëŸ¼
SELECT STORE_ID FROM SALES_TRANSACTION ST, STORE_MASTER SM
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION ST, STORE_MASTER SM"
}

19. í—ˆìš©ë˜ì§€ ì•Šì€ ì§‘ê³„ í•¨ìˆ˜
SELECT MEDIAN(QTY) FROM SALES_TRANSACTION
{
  "sql": "SELECT MEDIAN(QTY) FROM SALES_TRANSACTION"
}

20. DBMS_SQL
SELECT DBMS_SQL.PARSE('X') FROM DUAL
{
  "sql": "SELECT DBMS_SQL.PARSE('X') FROM DUAL"
}

21. whitelist * SELECT
SELECT * FROM SALES_TRANSACTION
{
  "sql": "SELECT * FROM SALES_TRANSACTION"
}

22. JOIN + WHERE X
SELECT A.STORE_ID FROM SALES_TRANSACTION A, STORE_MASTER B
{
  "sql": "SELECT A.STORE_ID FROM SALES_TRANSACTION A, STORE_MASTER B"
}

âœ… 1ï¸âƒ£ ì„±ê³µ ì¼€ì´ìŠ¤ (VALID ì²˜ë¦¬ë˜ì–´ì•¼ í•¨)
â‘  ë‹¨ìˆœ SELECT (ë‹¨ì¼ í…Œì´ë¸”, ì»¬ëŸ¼ ëª…ì‹œ)
{
  "sql": "SELECT STORE_ID, PRODUCT_ID FROM SALES_TRANSACTION"
}
â‘¡ ë°”ì¸ë”© ë³€ìˆ˜ OR (í—ˆìš©ëœ OR)
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID = :storeId OR PRODUCT_ID = :productId"
}
â‘¢ ì»¬ëŸ¼ ëŒ€ ì»¬ëŸ¼ OR (í—ˆìš©)
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID = PRODUCT_ID OR QTY = UNIT_PRICE"
}
â‘£ EXISTS + ì•ˆì „í•œ ì„œë¸Œì¿¼ë¦¬
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION ST WHERE EXISTS (SELECT 1 FROM STORE_MASTER SM WHERE SM.STORE_ID = ST.STORE_ID)"
}
â‘¤ IN (:list) â€” í•µì‹¬ í…ŒìŠ¤íŠ¸
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN (:storeIdList)"
}
â‘¥ IN (?) â€” ë‹¨ì¼ ë°”ì¸ë”©
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN (?)"
}
â‘¦ IN (ì„œë¸Œì¿¼ë¦¬)
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN (SELECT STORE_ID FROM STORE_MASTER)"
}
âŒ 2ï¸âƒ£ ì‹¤íŒ¨ ì¼€ì´ìŠ¤ (ì°¨ë‹¨ë˜ì–´ì•¼ í•¨)
ðŸ”¥ ê¸ˆì§€ í‚¤ì›Œë“œ (Parser ì´ì „ ë‹¨ê³„)
â‘§ ì„¸ë¯¸ì½œë¡  + DROP
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION; DROP TABLE USERS"
}
ðŸ”¥ SELECT * ì •ì±…
â‘¨ SELECT *
{
  "sql": "SELECT * FROM SALES_TRANSACTION"
}
â‘© SELECT T.*
{
  "sql": "SELECT ST.* FROM SALES_TRANSACTION ST"
}
ðŸ”¥ OR Injection
â‘ª ìƒìˆ˜ OR Injection
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID = STORE_ID OR '1'='1'"
}
â‘« OR + ìƒìˆ˜ ë¹„êµ
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID = 1 OR 1=1"
}
ðŸ”¥ EXISTS + Injection
â‘¬ EXISTS ë‚´ë¶€ OR Injection
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE EXISTS (SELECT 1 FROM SALES_TRANSACTION WHERE '1'='1')"
}
ðŸ”¥ IN (:list) ì •ì±… ìœ„ë°˜
â‘­ IN (ìƒìˆ˜ ë¦¬ìŠ¤íŠ¸)
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN (1,2,3)"
}
â‘® IN (ë¬¸ìž ë¦¬í„°ëŸ´ ë¦¬ìŠ¤íŠ¸)
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN ('A','B')"
}
â‘¯ IN (í˜¼í•©)
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN (1, :id)"
}
ðŸ”¥ Prefix ê·œì¹™ ìœ„ë°˜
â‘° ë‹¤ì¤‘ í…Œì´ë¸” + prefix ì—†ëŠ” ì»¬ëŸ¼
{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION ST JOIN STORE_MASTER SM ON ST.STORE_ID = SM.STORE_ID"
}
ðŸ”¥ Cartesian Product ì°¨ë‹¨
â‘± ë‹¤ì¤‘ í…Œì´ë¸” + ì¡°ê±´ ì—†ìŒ
{
  "sql": "SELECT ST.STORE_ID FROM SALES_TRANSACTION ST, STORE_MASTER SM"
}

{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN (1,2,3) OR 1=1"
}
ê¸°ëŒ€ ê²°ê³¼
{
  "ok": false,
  "message": "OR ì¡°ê±´ì— ìƒìˆ˜ ë¹„êµ ë˜ëŠ” ì¡°ê±´ ë¬´ë ¥í™” íŒ¨í„´ì´ í¬í•¨ë˜ì–´ ìžˆìŠµë‹ˆë‹¤"
}

{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN ('A','B') OR '1'='1'"
}

ê¸°ëŒ€ ê²°ê³¼
{
    "ok": false,
    "message": "OR ì¡°ê±´ì— ìƒìˆ˜ ë¹„êµ ë˜ëŠ” ì¡°ê±´ ë¬´ë ¥í™” íŒ¨í„´ì´ í¬í•¨ë˜ì–´ ìžˆìŠµë‹ˆë‹¤",
    "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN ('A','B') OR '1'='1'"
}

{
  "sql": "SELECT STORE_ID FROM SALES_TRANSACTION WHERE STORE_ID IN (1,2,3) OR STORE_ID = STORE_ID"
}

ê¸°ëŒ€ ê²°ê³¼
valid

{
"sql": "SELECT c.customer_id, c.company_name, c.sales_rep_id, SUM(i.amount) AS total_ltv, COUNT(CASE WHEN i.status = 'overdue' THEN 1 END) AS overdue_count, AVG(CASE WHEN i.paid_at IS NOT NULL THEN EXTRACT(DAY FROM (i.paid_at - i.created_at)) ELSE NULL END) AS avg_payment_delay_days, NTILE(5) OVER (ORDER BY SUM(i.amount) DESC) AS revenue_tier FROM customers c INNER JOIN subscriptions s ON c.customer_id = s.customer_id LEFT JOIN invoices i ON s.subscription_id = i.subscription_id WHERE i.created_at >= DATE_TRUNC('month', CURRENT_DATE - INTERVAL '12 months') GROUP BY c.customer_id, c.company_name, c.sales_rep_id"
}

{
"sql": "SELECT customer_id, usage_month, monthly_active_users, LAG(monthly_active_users, 1) OVER (PARTITION BY customer_id ORDER BY usage_month) AS prev_month_users, ROUND((monthly_active_users - LAG(monthly_active_users, 1) OVER (PARTITION BY customer_id ORDER BY usage_month))::NUMERIC / NULLIF(LAG(monthly_active_users, 1) OVER (PARTITION BY customer_id ORDER BY usage_month), 0) * 100, 2) AS growth_rate FROM (SELECT customer_id, DATE_TRUNC('month', log_date) AS usage_month, COUNT(DISTINCT user_id) AS monthly_active_users FROM usage_logs WHERE log_date >= DATE_TRUNC('month', CURRENT_DATE - INTERVAL '6 months') GROUP BY customer_id, DATE_TRUNC('month', log_date)) raw_usage"
}

{
"sql": "SELECT customer_id, COUNT(*) AS negative_trend_months, MIN(growth_rate) AS max_drop_rate FROM MonthlyUsageStats WHERE growth_rate < -15.0 AND usage_month >= DATE_TRUNC('month', CURRENT_DATE - INTERVAL '3 months') GROUP BY customer_id"
}

{
"sql": "SELECT r.region_name, sr.rep_name, cf.revenue_tier AS customer_tier, COUNT(cf.customer_id) AS total_managed_customers, SUM(CASE WHEN (cs.negative_trend_months >= 2 OR cf.overdue_count > 0) AND cf.revenue_tier = 1 THEN 1 ELSE 0 END) AS high_risk_vip_count, ROUND(AVG(COALESCE(cs.negative_trend_months * 10, 0) + (cf.overdue_count * 5) + (CASE WHEN cf.avg_payment_delay_days > 7 THEN 20 ELSE 0 END)), 1) AS avg_risk_score, TO_CHAR(SUM(cf.total_ltv), 'FM999,999,999,999') AS portfolio_value FROM CustomerFinancials cf JOIN sales_reps sr ON cf.sales_rep_id = sr.rep_id JOIN regions r ON sr.region_id = r.region_id LEFT JOIN ChurnSignals cs ON cf.customer_id = cs.customer_id WHERE sr.team_id IN (SELECT team_id FROM sales_reps GROUP BY team_id HAVING SUM(quota_attainment) / COUNT(*) > 0.8) GROUP BY r.region_name, sr.rep_name, cf.revenue_tier HAVING SUM(cf.total_ltv) > 10000 ORDER BY avg_risk_score DESC, portfolio_value DESC"
}